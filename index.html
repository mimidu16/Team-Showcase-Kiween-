<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Team Showcase</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@400;500&display=swap');
    body { margin: 0; background: transparent; font-family: "DM Sans", sans-serif; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; width: 90%; max-width: 1000px; margin: 24px auto; }
    .card { position: relative; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 20px rgba(0,0,0,0.15); background: #000; }
    .card img { width: 100%; height: auto; display: block; }
    .overlay { position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding: 24px; text-align: center; }
    .overlay::before { content: ""; position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.92) 0%, rgba(0,0,0,0.55) 40%, rgba(0,0,0,0.0) 70%); z-index: 0; }
    .overlay .content { position: relative; z-index: 1; display: flex; flex-direction: column; align-items: center; color: #fff; }
    .overlay .content > * { margin: 0; }
    .overlay .content > * + * { margin-top: 12px; }
    .overlay .content p + button { margin-top: 20px; }
    .overlay h3 { font-family: "Playfair Display", serif; font-size: 18px; }
    .overlay p { font-size: 16px; }
    .overlay button { font-family: "DM Sans", sans-serif; font-size: 16px; background: #fff; color: #000; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: transform .15s ease, opacity .15s ease; }
    .overlay button:hover { transform: translateY(-1px); opacity: .95; }
    .modal { display: none; position: fixed; inset: 0; z-index: 10; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; padding: 16px; }
    .modal-content { background: #fff; padding: 24px; border-radius: 12px; max-width: 400px; width: 100%; text-align: center; font-family: "DM Sans", sans-serif; }
    .modal-content h2 { font-family: "Playfair Display", serif; margin-top: 0; }
    .close { margin-top: 16px; padding: 8px 16px; background: #000; color: #fff; border: none; border-radius: 8px; cursor: pointer; }
  </style>
</head>
<body>

  <div class="grid" id="teamGrid"></div>
  <div id="modalsContainer"></div>

  <script>
    const sheetCSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2QG9oHTqtTL9lCOwf3Uy3QLHWxFeYyVPiG4Jc-I8mUiMl9ZuR-0gIZv7VM8AD3j6Bpshnb-RJnTR_/pubhtml?output=csv';

    // Parseur CSV maison
    function parseCSV(text) {
      const rows = [];
      let current = '', row = [], insideQuotes = false;

      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        if (char === '"') {
          if (insideQuotes && text[i+1] === '"') { current += '"'; i++; }
          else insideQuotes = !insideQuotes;
        } else if (char === ',' && !insideQuotes) {
          row.push(current); current = '';
        } else if ((char === '\n' || char === '\r') && !insideQuotes) {
          if (current || row.length) { row.push(current); rows.push(row); row = []; current = ''; }
        } else {
          current += char;
        }
      }
      if (current || row.length) row.push(current);
      if (row.length) rows.push(row);
      return rows;
    }

    // Fonction de chargement
    function loadTeam() {
      fetch(sheetCSV + '&nocache=' + Date.now()) // üî• Anti-cache ajout√©
        .then(res => res.text())
        .then(csvText => {
          const data = parseCSV(csvText);
          const headers = data[0].map(h => h.trim().toLowerCase());
          const rows = data.slice(1);

          // R√©initialiser affichage
          document.getElementById('teamGrid').innerHTML = "";
          document.getElementById('modalsContainer').innerHTML = "";

          rows.forEach((cols, index) => {
            if (!cols.length || cols.every(c => !c.trim())) return;

            const rowObj = {};
            headers.forEach((h, i) => rowObj[h] = cols[i] ? cols[i].trim() : "");

            const name = rowObj.name || "Inconnu";
            const role = rowObj.role || "";
            const des = rowObj.des || "Pas de description disponible.";
            const img = rowObj.img || "https://via.placeholder.com/400x250?text=Image+manquante";

            // cr√©er card
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
              <img src="${img}" alt="${name}" onerror="this.src='https://via.placeholder.com/400x250?text=Image+manquante'">
              <div class="overlay">
                <div class="content">
                  <h3>${name}</h3>
                  <p>${role}</p>
                  <button onclick="openModal('modal${index}')">En savoir plus</button>
                </div>
              </div>
            `;
            document.getElementById('teamGrid').appendChild(card);

            // cr√©er modal
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = `modal${index}`;
            modal.innerHTML = `
              <div class="modal-content">
                <h2>${name}</h2>
                <p>${desc}</p>
                <button class="close" onclick="closeModal('modal${index}')">Fermer</button>
              </div>
            `;
            document.getElementById('modalsContainer').appendChild(modal);
          });
        });
    }

    // Chargement initial
    loadTeam();

    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    window.addEventListener('click', (e) => { 
      document.querySelectorAll('.modal').forEach(m => { 
        if (e.target === m) m.style.display='none'; 
      }); 
    });
  </script>

</body>

</html>

